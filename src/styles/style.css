@layer theme, base, components, utilities;

@import 'tailwindcss/theme.css' layer(theme);
@import 'tailwindcss/preflight.css' layer(base);
@import 'tailwindcss/utilities.css' layer(utilities);
@plugin "@tailwindcss/typography";

@theme {
  /* Primary */
  --color-primary-50: #fff5f2;
  --color-primary-100: #ffe1da;
  --color-primary-200: #ffc2b5;
  --color-primary-300: #ffa08e;
  --color-primary-400: #ff856e;
  --color-primary-500: #ff6b4a;
  --color-primary-600: #e55538;
  --color-primary-700: #cc442c;
  --color-primary-800: #b23622;
  --color-primary-900: #8c2515;

  /* Secondary */
  --color-secondary-50: #fffcf2;
  --color-secondary-100: #fff6d9;
  --color-secondary-200: #ffedb3;
  --color-secondary-300: #ffe48c;
  --color-secondary-400: #ffdd74;
  --color-secondary-500: #ffd66b;
  --color-secondary-600: #e5bc52;
  --color-secondary-700: #cc9f3e;
  --color-secondary-800: #b28530;
  --color-secondary-900: #8c6120;

  /* Success */
  --color-success-50: #f3faf4;
  --color-success-100: #d7f2da;
  --color-success-200: #b1e5b7;
  --color-success-300: #8bd994;
  --color-success-400: #68cc75;
  --color-success-500: #4caf50;
  --color-success-600: #3d9443;
  --color-success-700: #317a36;
  --color-success-800: #26602b;
  --color-success-900: #1a421d;

  /* Error */
  --color-error-50: #fdeded;
  --color-error-100: #fbd4d4;
  --color-error-200: #f5a9a9;
  --color-error-300: #ec7777;
  --color-error-400: #e05252;
  --color-error-500: #c92d2d;
  --color-error-600: #a52323;
  --color-error-700: #7f1b1b;
  --color-error-800: #5a1212;
  --color-error-900: #370a0a;

  /* Warning */
  --color-warning-50: #fffaf0;
  --color-warning-100: #fff3d6;
  --color-warning-200: #ffe3a6;
  --color-warning-300: #ffd372;
  --color-warning-400: #fbc447;
  --color-warning-500: #e6a812;
  --color-warning-600: #ba860e;
  --color-warning-700: #8c660b;
  --color-warning-800: #5e4507;
  --color-warning-900: #302404;

  /* Background (semantic) */
  --color-background-base: #fbfaf6;
  --color-background-white: #fafaf9;

  /* Text (semantic) */
  --color-text-primary: #2c2c2c;
  --color-text-secondary: #6f6f6f;
}

@theme {
  --scroll-thumb: #ffd2c6;
  --scroll-thumb-hover: #ffb89e;
}

@layer base {
  html,
  body {
    @apply scroll-smooth;
    font-family:
      var(--font-orbitron),
      var(--font-nanum),
      -apple-system,
      BlinkMacSystemFont,
      system-ui,
      Roboto,
      'Helvetica Neue',
      'Segoe UI',
      'Apple SD Gothic Neo',
      'Noto Sans KR',
      sans-serif;
    line-height: 1.5;
    font-weight: 500;
    background-color: var(--color-background-base);
  }

  .editor :where(.ProseMirror, .ProseMirror *),
  .tiptap-renderer {
    font-family:
      var(--font-nanum),
      -apple-system,
      system-ui,
      'Apple SD Gothic Neo',
      'Noto Sans KR',
      sans-serif !important;
    line-height: 1.1;
    text-underline-offset: 0.35rem;
    text-decoration-thickness: 0.06em;

    a {
      color: dodgerblue !important;
      text-underline-offset: 0.25em;
    }

    p {
      margin: 0.5rem 0 !important;
    }
  }

  :root {
    --toastify-color-success: theme(--color-success-500) !important;
    --toastify-color-error: theme(--color-error-400) !important;
    --toastify-color-warning: theme(--color-warning-500) !important;
    --toastify-color-info: theme(colors.rose.600);
    --toastify-font-family: var(--font-orbitron), var(--font-nanum) !important;
  }

  * {
    scrollbar-width: thin;
    scrollbar-color: var(--scroll-thumb) transparent;
  }

  *::-webkit-scrollbar {
    width: 10px;
    height: 10px;
  }

  *::-webkit-scrollbar-track {
    background: transparent;
  }

  *::-webkit-scrollbar-thumb {
    background-color: var(--scroll-thumb);
    border-radius: 999px;
    border: 2px solid transparent;
    background-clip: padding-box;
  }

  *::-webkit-scrollbar-thumb:hover {
    background-color: var(--scroll-thumb-hover);
  }

  input:-webkit-autofill {
    -webkit-box-shadow: 0 0 0px 1000px var(--color-background-white) inset !important;
    box-shadow: 0 0 0px 1000px var(--color-background-white) inset !important;
    -webkit-text-fill-color: var(--color-text-primary) !important;
    transition: background-color 5000s ease-in-out 0s;
  }

  :root {
    --fall-dur: 1.8s; /* 고양이 넘어짐 전체 시간 */
    --shake-dur: 0.5s; /* 흔들림 시간 */
    --star-dur: 1.6s; /* 별 한 바퀴 */
  }
}

@layer utilities {
  /* scroll bar */
  .scrollbar-none {
    scrollbar-width: none;
  }

  .scrollbar-none::-webkit-scrollbar {
    display: none;
  }

  /* spinner */
  .animation-spinner {
    aspect-ratio: 2;
    border-bottom: 3px solid var(--color-secondary-900);
    position: relative;
    overflow: hidden;

    &:before {
      content: '';
      position: absolute;
      inset: auto 42.5% 0;
      aspect-ratio: 1;
      width: 2rem;
      height: 2rem;
      border-radius: 50%;
      background: url('/image/cat-default.svg') no-repeat center/contain;
      animation:
        spinner-0 0.5s cubic-bezier(0, 900, 1, 900) infinite,
        spinner-1 2.5s linear infinite;
    }
  }

  /* like button */
  .animate-like-pop {
    animation: like-pop 360ms cubic-bezier(0.2, 0.8, 0.2, 1);
  }

  /* 404 Cat */
  .tear-drop {
    position: absolute;
    left: 0;
    top: 0;
    width: 8px;
    height: 12px;
    border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
    background: #58a6ff;
    filter: drop-shadow(0 1px 0 rgba(0, 0, 0, 0.15));
    animation: tearFall 2.8s ease-in-out infinite;
    animation-delay: var(--delay, 0s);
    transform: translate(calc(var(--spread, 12px) * -0.15), 0);
  }
  .puddle {
    position: relative;
    height: 10px;
    border-radius: 9999px;
    background: rgba(88, 166, 255, 0.25);
    box-shadow: 0 0 0 2px rgba(88, 166, 255, 0.12) inset;
    transform-origin: center;
    animation: puddleGrow 6s ease-out forwards;
  }
  .puddle-ring {
    position: absolute;
    left: 50%;
    top: 50%;
    width: 70%;
    height: 140%;
    transform: translate(-50%, -50%);
    border-radius: 9999px;
    border: 2px solid rgba(88, 166, 255, 0.35);
    animation: puddleRipple 1.8s ease-out infinite;
  }
  .puddle-ring.delay-300 {
    animation-delay: 0.3s;
  }

  /* Error Fallback Cat */
  .cat-fall {
    animation: catFall var(--fall-dur) ease-in-out forwards;
    object-fit: contain;
    will-change: transform;
  }
  .shake {
    animation: shake var(--shake-dur, 0.5s) ease-in-out;
  }
  .stars {
    position: absolute;
    left: 22%;
    top: 32%;
    width: 0;
    height: 0;
    opacity: 0;
    pointer-events: none;
    transform: translate(-50%, -50%) scaleX(0.8) scaleY(0.65);
  }
  .star {
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    font-size: 1.5rem;
    animation: spinStar var(--star-dur, 1.6s) linear infinite;
    animation-play-state: paused;
    opacity: 0;
  }
  .stars.active {
    opacity: 1;
  }
  .star--1 {
    --orbit: 40px;
    animation-delay: 0.5s;
  }
  .star--2 {
    --orbit: 40px;
    animation-delay: 1s;
  }
  .star--3 {
    --orbit: 40px;
    animation-delay: 1.5s;
  }
  .stars.active .star {
    animation-play-state: running;
  }
  @media (prefers-reduced-motion: reduce) {
    .cat-fall,
    .shake,
    .star {
      animation: none !important;
    }
    .stars {
      opacity: 0.2;
    }
  }

  /* animation keyframes */
  @keyframes spinner-0 {
    0%,
    2% {
      bottom: 0%;
    }
    98%,
    to {
      bottom: 0.1%;
    }
  }
  @keyframes spinner-1 {
    0% {
      translate: -500%;
    }
    to {
      translate: 500%;
    }
  }
  @keyframes like-pop {
    0% {
      transform: scale(1) rotate(0deg);
    }
    30% {
      transform: scale(1.2) rotate(-8deg);
    }
    60% {
      transform: scale(1.1) rotate(8deg);
    }
    100% {
      transform: scale(1) rotate(0deg);
    }
  }
  @keyframes tearFall {
    0% {
      opacity: 0;
      transform: translate(0, 0) scale(0.6);
    }
    10% {
      opacity: 1;
    }
    80% {
      transform: translate(var(--dx, 10px), calc(var(--fall, 120px) * 0.6)) scale(0.85);
    }
    100% {
      opacity: 0;
      transform: translate(calc(var(--dx, 10px) * 1.2), var(--fall, 120px));
    }
  }
  @keyframes puddleGrow {
    0% {
      transform: scaleX(0.5);
      opacity: 0.4;
    }
    50% {
      transform: scaleX(1.2);
      opacity: 0.6;
    }
    100% {
      transform: scaleX(2);
      opacity: 0.8;
    }
  }
  @keyframes puddleRipple {
    0% {
      transform: scale(0.7);
      opacity: 0.6;
    }
    70% {
      opacity: 0.2;
    }
    100% {
      transform: scale(1.12);
      opacity: 0;
    }
  }
  @keyframes catFall {
    0% {
      transform: translateX(0%) translateY(0) rotate(0) rotateY(0deg);
    }
    20% {
      transform: translateX(25%) translateY(0) rotate(-8deg) rotateY(180deg);
    }
    35% {
      transform: translateX(10%) translateY(-5px) rotate(8deg) rotateY(0deg);
    }
    50% {
      transform: translateX(0%) translateY(0) rotate(-12deg) rotateY(180deg);
    }
    65% {
      transform: translateX(0%) translateY(0) rotate(12deg) rotateY(0deg);
    }
    80% {
      transform: translateX(-10%) translateY(10px) rotate(-18deg) rotateY(180deg);
    }
    100% {
      transform: translateX(-12%) translateY(30px) rotate(-90deg) rotateY(0deg);
    }
  }
  @keyframes shake {
    0%,
    100% {
      transform: translateX(0);
    }
    20% {
      transform: translateX(-10px);
    }
    40% {
      transform: translateX(10px);
    }
    60% {
      transform: translateX(-6px);
    }
    80% {
      transform: translateX(6px);
    }
  }
  @keyframes spinStar {
    0% {
      transform: rotate(0deg) translate(var(--orbit, 30px)) rotate(0deg);
      opacity: 0;
    }
    1% {
      opacity: 1;
    }
    100% {
      transform: rotate(360deg) translate(var(--orbit, 30px)) rotate(-360deg);
      opacity: 0;
    }
  }
}
